<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content=",,">










<meta name="description" content="视频通道，录制端选定屏幕上区域后录制上传到云端存储，浏览器端实时拉取并播放 指令通道，浏览器端上传指令到云端，接收端接收指令并根据预定义策略执行  ¶视频通道 cocos2d-x 实现视频播放 ¶视频录制 javacv 实现录屏 ¶视频传输技术选型  利用 WebRtc 技术实现在线直播 源自谷歌，还饱受争议。有过项目经历的开发者说到，让粉丝们来看直播，如果同时粉丝数&amp;gt;10 人，那么不关">
<meta name="keywords" content="Distributed System,Cloud">
<meta property="og:type" content="website">
<meta property="og:title" content="设计一个简易的云游戏系统">
<meta property="og:url" content="https://tallate.github.io/draft/项目/设计一个简易的云游戏系统.html">
<meta property="og:site_name" content="Tallate">
<meta property="og:description" content="视频通道，录制端选定屏幕上区域后录制上传到云端存储，浏览器端实时拉取并播放 指令通道，浏览器端上传指令到云端，接收端接收指令并根据预定义策略执行  ¶视频通道 cocos2d-x 实现视频播放 ¶视频录制 javacv 实现录屏 ¶视频传输技术选型  利用 WebRtc 技术实现在线直播 源自谷歌，还饱受争议。有过项目经历的开发者说到，让粉丝们来看直播，如果同时粉丝数&amp;gt;10 人，那么不关">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://47.88.24.11/imgs/cgh/OBS-1.png">
<meta property="og:image" content="http://47.88.24.11/imgs/cgh/OBS-2.png">
<meta property="og:updated_time" content="2020-09-28T13:11:01.989Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="设计一个简易的云游戏系统">
<meta name="twitter:description" content="视频通道，录制端选定屏幕上区域后录制上传到云端存储，浏览器端实时拉取并播放 指令通道，浏览器端上传指令到云端，接收端接收指令并根据预定义策略执行  ¶视频通道 cocos2d-x 实现视频播放 ¶视频录制 javacv 实现录屏 ¶视频传输技术选型  利用 WebRtc 技术实现在线直播 源自谷歌，还饱受争议。有过项目经历的开发者说到，让粉丝们来看直播，如果同时粉丝数&amp;gt;10 人，那么不关">
<meta name="twitter:image" content="http://47.88.24.11/imgs/cgh/OBS-1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://tallate.github.io/draft/项目/设计一个简易的云游戏系统.html">







  <title>设计一个简易的云游戏系统 | Tallate</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tallate</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">不乱于心，不困于情，不畏将来，不念过往</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>

      <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    
    
    
    <div class="post-block page">
      <header class="post-header">


	<h1 class="post-title" itemprop="name headline">设计一个简易的云游戏系统</h1>








</header>






      
      
      
      <div class="post-body">
        
        
          <ol>
<li>视频通道，录制端选定屏幕上区域后录制上传到云端存储，浏览器端实时拉取并播放</li>
<li>指令通道，浏览器端上传指令到云端，接收端接收指令并根据预定义策略执行</li>
</ol>
<h2 id="视频通道"><a class="header-anchor" href="#视频通道">¶</a>视频通道</h2>
<p>cocos2d-x 实现视频播放</p>
<h3 id="视频录制"><a class="header-anchor" href="#视频录制">¶</a>视频录制</h3>
<p>javacv 实现录屏</p>
<h3 id="视频传输技术选型"><a class="header-anchor" href="#视频传输技术选型">¶</a>视频传输技术选型</h3>
<ol>
<li>利用 WebRtc 技术实现在线直播<br>
源自谷歌，还饱受争议。有过项目经历的开发者说到，让粉丝们来看直播，如果同时粉丝数&gt;10 人，那么不关 WebRtc 的事，一个是 webRtc 基于 chrome 浏览器在短时间内占用内存太大，一旦直播时长超过一定时间就容易服务器崩溃；另外一方面，WebRtc 是针对小型在线会议开发的，他对并发会有很大的限制，一旦人数达到上百甚至上千，服务器也将不堪重任。但它有技术支持，未来可能会有希望</li>
<li>利用 java 原生态 JMF 音频视频传输技术<br>
这是 java 自带的音频和视频传输技术，在发布之后基本没有更新，它的着重点是对于音频和视频的在线点播实现而非直播技术，但它可以实现对客户端音频和视频的采集，效率也相对低下。</li>
<li>使用 nginx rtmp-module 和 nginx hls 架设<br>
Nginx 一般是在 Linux 系统上部署的小型 Web 服务器,他可以使用苹果原生的 Apple SDK 进行 hls 协议流媒体发布，或者使用 adobe 的 FMS 搭建 hls 服务。<br>
但 FMS 是收费的，需要商用 licence。它的优点在于可以简单快捷拿到流媒体文件，包括 rtmp 和 m3u8，且做分层比较简单。局限性在于多用 C 语言进行编码，没有开源的成熟界面操作，需要二次编写。</li>
<li>利使用 red5+red5 HLS Plugin 搭建服务器<br>
Red5 是开源的 Java 项目，他可以快速生成 rtmp 流媒体文件，利用 ffmeg 进行编码后可以分发到客户端进行观看，此外提供 hls 插件用来转 hls 协议，可以实现整个直播业务。它的优点在于可以快速搭建服务器并简单拿到流媒体数据，并且项目开源比较好做开发。局限在于他的 hls 插件三年没有更新了很多仓储的 Jar 包无法获取，需要花时间获得。</li>
<li>利用 red5Pro +HLS + HTML5 搭建服务器<br>
Red5Pro 是 red5 的加强版流媒体服务器，它在移动端完全支持 hls 协议，但仅限于安卓和 IOS 平台，在这两个平台上可以快速搭建直播环境。但它也有开源利用 node.js 技术的搭建 H5 HLS 直播环境。现在正在研究怎样使用它的 Red5 Pro HTML5 HLS Example。</li>
</ol>
<p>常见直播协议：</p>
<ul>
<li>RTMP: 底层基于 TCP，在浏览器端依赖 Flash。</li>
<li>HTTP-FLV: 基于 HTTP 流式 IO 传输 FLV，依赖浏览器支持播放 FLV。</li>
<li>WebSocket-FLV: 基于 WebSocket 传输 FLV，依赖浏览器支持播放 FLV。WebSocket 建立在 HTTP 之上，建立 WebSocket 连接前还要先建立 HTTP 连接。</li>
<li>HLS: Http Live Streaming，苹果提出基于 HTTP 的流媒体传输协议。HTML5 可以直接打开播放。</li>
<li>RTP: 基于 UDP，延迟 1 秒，浏览器不支持。</li>
</ul>
<h3 id="推流客户端-obs"><a class="header-anchor" href="#推流客户端-obs">¶</a>推流客户端 - OBS</h3>
<p>一些主播录制视频然后上传的客户端其实就是 OBS，它做了两件事：</p>
<ol>
<li>从“来源”获取视频<br>
<img src="http://47.88.24.11/imgs/cgh/OBS-1.png" alt="OBS-1" title="OBS-1"></li>
<li>推流到视频服务器<br>
<img src="http://47.88.24.11/imgs/cgh/OBS-2.png" alt="OBS-2" title="OBS-2"></li>
</ol>
<h2 id="指令通道"><a class="header-anchor" href="#指令通道">¶</a>指令通道</h2>
<p>通过 Netty 实现自定义协议的读取<br>
键盘点击指令的实现<br>
cocos2d-x 读取指令并上传</p>
<h3 id="序列化协议"><a class="header-anchor" href="#序列化协议">¶</a>序列化协议</h3>
<p>JSON、XML、JDK、Hession：性能较低<br>
Kryo：只支持 Java 平台<br>
Protobuf</p>
<p>C++实现序列化的问题：</p>
<ol>
<li>源服务器与目标服务器的位数不同；</li>
<li>源服务器与目标服务器的字节序不同；<br>
一个比较好的策略是由流来决定字节序，当写一个多字节数据类型时，如果平台的字节序与所选的流字节序不匹配时，在写入流时数据的字节序将被颠倒。同理，当从流中读出数据时，如果平台的字节序与流字节序不相同时，字节序应该被颠倒。<br>
为了判断字节序的一致性，一种可行的办法是序列化的时候在数据包头部添加一个 MagicNumber，通过判断读出的值和预期值是否颠倒即可得知字节序是否不一致，然后再采用字节交换函数来颠倒数据。</li>
</ol>
<p>另外，其实也可以使用一些序列化协议（如 ProtoBuf），将数据全部序列化为字节序列，因为根本没有 int、long 等多字节数据类型，字节序问题也就不存在了。</p>
<ol>
<li>进程不同，指针指向的位置（内存地址）也不同，注意深拷贝的实现，避免解析循环引用时导致死循环；<br>
一种解决办法是给每个多处引用的对象一个唯一的标识符，网络的另一端反序列时可以使用这个标识符来找到引用对象。</li>
<li>输入输出流的缓冲</li>
<li>预分配内存</li>
</ol>
<h2 id="protobuf"><a class="header-anchor" href="#protobuf">¶</a>Protobuf</h2>
<h3 id="问题"><a class="header-anchor" href="#问题">¶</a>问题</h3>
<ol>
<li>Xcode 编译提示错误：google/protobuf/stubs/common.h file not found<br>
需要安装 protobuf。</li>
</ol>
<h3 id="netty-优化"><a class="header-anchor" href="#netty-优化">¶</a>Netty 优化</h3>
<ol>
<li>缓冲区 flush<br>
统一 flush 而不是写一次 flush 一次。</li>
<li>Sharable<br>
无状态的 Handler 可以提供给多个 Channel 复用，不必每次实例化一个新的，提升了效率，且减少了空间浪费。<br>
要注意一些 Handler 默认不支持 Sharable，比如 MessageToByteEncoder、ByteToMessageDecoder、LengthFieldBasedFrameDecoder。</li>
<li>缩短事件传播路径<br>
合并平行 Handler<br>
使用<code>ctx.writeAndFlush()</code>而不是<code>ctx.channel().writeAndFlush()</code>。如果 inBound 类型的 Handler 中调用<code>ctx.channel().writeAndFlush()</code>，对象会从最后一个 outBound 类型的 Handler 开始逐个往前传播，而<code>ctx.writeAndFlush()</code>是从 pipeline 链中的当前节点开始往前找第一个 outBound 类型的 Handler 并开始往前传播。</li>
<li>减少主线程的阻塞<br>
Handler 中涉及到数据库或网络请求的代码执行比较耗时，会阻塞主线程，一般来说这种情况都可以将耗时请求放到另一个业务线程池中执行。</li>
</ol>
<h3 id="cocos2d-x"><a class="header-anchor" href="#cocos2d-x">¶</a>Cocos2d-X</h3>
<h3 id="node"><a class="header-anchor" href="#node">¶</a>Node</h3>
<ol>
<li>代表一个容器，能包含 Sprite 或其他 Node</li>
<li>容器包括三种：Scene、Layer、sprite</li>
</ol>
<h3 id="scene"><a class="header-anchor" href="#scene">¶</a>Scene</h3>
<ol>
<li>一般包含一个或多个 Layer；</li>
<li>一个 Application 往往被设计为多个 Scene</li>
</ol>
<h3 id="layer"><a class="header-anchor" href="#layer">¶</a>Layer</h3>
<ol>
<li>一般包含一个或多个 Sprite；</li>
<li>一些特殊的 Layer 类如 Menu、LayerColor</li>
</ol>
<h3 id="sprite"><a class="header-anchor" href="#sprite">¶</a>Sprite</h3>
<ol>
<li>包含图片</li>
<li>如果有意可以使用一个 Scene、一个 Layer 和许多个 Sprite 来实现一个游戏</li>
</ol>
<h3 id="director"><a class="header-anchor" href="#director">¶</a>Director</h3>
<ol>
<li>管理所有 Scene，知道整个程序</li>
<li>单例；</li>
</ol>
<h3 id="cache"><a class="header-anchor" href="#cache">¶</a>Cache</h3>
<ol>
<li>保存程序运行中的信息；</li>
<li>单例，比如 TextureCache、SpriteFrameCache、AnimationCache</li>
</ol>
<h2 id="项目结构"><a class="header-anchor" href="#项目结构">¶</a>项目结构</h2>
<ul>
<li>Resources<br>
图片资源</li>
<li>ios<br>
应用在 iOS 上运行所必须的链接文件。同理，如果存储的是在 Android 平台上运行所需要的链接文件，则文件夹为 android。</li>
<li>libs<br>
cocos2dx 相关的所有库文件，还有 CocosDenshion 文件（声音支持）及其他扩展。</li>
<li>Classes<br>
应用代码，这里的代码应当是平台无关的，不应随着平台的变更而更改。</li>
</ul>
<p>1.下载<br>
<a href="https://cocos2d-x.org/download" target="_blank" rel="noopener">Cocos2d-x downloads page</a></p>
<ol>
<li>将命令行工具添加到 PATH 环境变量<br>
<code>/Users/huanggaochi/Documents/cocos2d-x-4.0/tools/cocos2d-console/bin</code></li>
<li>创建项目<br>
下面建一个名为 cgh-client 的 cocos2dx 项目。</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cocos new -p com.tallate.cgh-client -l cpp -d ./ cgh-client</span><br><span class="line">-p: 指定包名</span><br><span class="line">-l: 指定语言</span><br><span class="line">-d: 指定项目所处目录</span><br></pre></td></tr></table></figure>
<ol>
<li>构建运行 Xcode 项目 for macOS<br>
我的系统是 mac，因此我希望将项目导入到 Xcode 中，刚创建的项目无法直接导入到 Xcode 中，先按<a href="https://docs.cocos2d-x.org/cocos2d-x/v4/zh/installation/OSX.html" target="_blank" rel="noopener">官网上的方法</a>初始化一下：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd cgh-client</span><br><span class="line">mkdir mac-build</span><br><span class="line">cd mac-build</span><br><span class="line">cmake .. -GXcode</span><br></pre></td></tr></table></figure>
<p>然后进入 mac-build 目录，双击<code>cgh-client.xcodeproj</code>文件就可以在 Xcode 里打开项目了。<br>
接下来 Product -&gt; Scheme -&gt; Edit Scheme -&gt; Run -&gt; Run 页签里选择项目的 Executable（不同版本的打开方式可能有所区别），这个步骤选择项目的可执行文件，否则点项目<code>Build and Run</code>后不会有任何反应。<br>
同样在上面 Edit Scheme 页面里，在 Build -&gt; Pre-actions 页签里添加预执行脚本<code>cmake . -GXcode</code>。</p>
<ol>
<li>其他环境<br>
见官网说明：<a href="https://docs.cocos.com/cocos2d-x/manual/zh/installation/" target="_blank" rel="noopener">环境搭建</a></li>
</ol>
<h2 id="参考"><a class="header-anchor" href="#参考">¶</a>参考</h2>
<h3 id="指令"><a class="header-anchor" href="#指令">¶</a>指令</h3>
<ol>
<li>protobuf<br>
<a href="https://github.com/protocolbuffers/protobuf/tree/master/java" target="_blank" rel="noopener">protocolbuffers / protobuf</a><br>
<a href="https://developers.google.com/protocol-buffers/docs/javatutorial" target="_blank" rel="noopener">Protocol Buffer Basics: Java</a><br>
<a href="https://developers.google.com/protocol-buffers/docs/proto" target="_blank" rel="noopener">Language Guide</a><br>
<a href="https://developers.google.com/protocol-buffers/docs/reference/java/index.html" target="_blank" rel="noopener">API</a></li>
</ol>
<h3 id="指令服务器"><a class="header-anchor" href="#指令服务器">¶</a>指令服务器</h3>
<p><a href="https://docs.oracle.com/javase/10/docs/api/java/awt/Robot.html" target="_blank" rel="noopener">Class Robot</a><br>
<a href="https://blog.csdn.net/qq_39598086/article/details/79053955" target="_blank" rel="noopener">如何用 java 控制你的电脑？</a></p>
<h3 id="视频"><a class="header-anchor" href="#视频">¶</a>视频</h3>
<ol>
<li></li>
</ol>
<p><a href="https://blog.csdn.net/iamniconico/article/details/80581937" target="_blank" rel="noopener">用 Java 开启直播之路（一）</a><br>
<a href="https://blog.csdn.net/iamniconico/article/details/80606035" target="_blank" rel="noopener">用 Java 开启直播之路（二）</a></p>
<ol>
<li>JavaCV<br>
<a href="https://github.com/bytedeco/javacpp" target="_blank" rel="noopener">bytedeco / javacpp</a><br>
<a href="https://github.com/bytedeco/javacv" target="_blank" rel="noopener">bytedeco / javacv</a><br>
<a href="https://www.cnblogs.com/eguid/category/1373171.html" target="_blank" rel="noopener">JavaCV 开发详解</a><br>
<a href="https://github.com/bytedeco/javacv/tree/master/samples/" target="_blank" rel="noopener">samples</a></li>
<li><a href="https://tools.ietf.org/html/draft-pantos-http-live-streaming-18" target="_blank" rel="noopener">HTTP Live Streaming（HLS 协议）</a><br>
<a href="https://segmentfault.com/a/1190000008810572" target="_blank" rel="noopener">HLS 协议详解</a></li>
<li>WebRTC<br>
<a href="https://webrtc.github.io/samples/" target="_blank" rel="noopener">WebRTC samples</a><br>
<a href="https://www.html5rocks.com/en/tutorials/webrtc/basics/" target="_blank" rel="noopener">Getting Started with WebRTC</a><br>
<a href="https://www.cnblogs.com/lingyunhu/tag/webrtc%20android%20ios/default.html?page=4" target="_blank" rel="noopener">Android IOS WebRTC 音视频开发总结</a></li>
<li>red5<br>
<a href="https://gitee.com/jarbean/red5-server" target="_blank" rel="noopener">kevin / red5-server</a><br>
<a href="https://github.com/Red5/red5-server" target="_blank" rel="noopener">Red5 / red5-server</a><br>
<a href="https://github.com/Red5/red5-client" target="_blank" rel="noopener">Red5 / red5-client</a><br>
<a href="https://gitee.com/endlesshh/red5_hls" target="_blank" rel="noopener">endless / red5_hls</a><br>
<a href="https://www.cnblogs.com/president/p/9438042.html" target="_blank" rel="noopener">开源流媒体 Red5-编译和部署</a></li>
<li><a href="https://obsproject.com/download" target="_blank" rel="noopener">OBS</a><br>
<a href="https://github.com/obsproject/obs-studio" target="_blank" rel="noopener">obsproject / obs-studio</a></li>
</ol>
<h3 id="cocos2d-x-v2"><a class="header-anchor" href="#cocos2d-x-v2">¶</a>Cocos2d-x</h3>
<ol>
<li><a href="https://devga.me/tutorials/cocos-creator-crash-course-tutorial-series/" target="_blank" rel="noopener">Cocos Creator Crash Course Tutorial Series by Devga.me</a></li>
<li><a href="http://cocos2d-x.org/learn#" target="_blank" rel="noopener">Tutorials from Make School</a></li>
<li><a href="https://www.iconfont.cn/?spm=a313x.7781069.1998910419.d4d0a486a" target="_blank" rel="noopener">iconfont</a></li>
</ol>

        
      </div>
      
      
      
    </div>
    
    
    
  </div>


          </div>
          


          

  
    <div id="gitalk-container"></div>

  

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">tallate</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">118</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">57</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#视频通道"><span class="nav-number">1.</span> <span class="nav-text">¶视频通道</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#视频录制"><span class="nav-number">1.1.</span> <span class="nav-text">¶视频录制</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视频传输技术选型"><span class="nav-number">1.2.</span> <span class="nav-text">¶视频传输技术选型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#推流客户端-obs"><span class="nav-number">1.3.</span> <span class="nav-text">¶推流客户端 - OBS</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#指令通道"><span class="nav-number">2.</span> <span class="nav-text">¶指令通道</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#序列化协议"><span class="nav-number">2.1.</span> <span class="nav-text">¶序列化协议</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#protobuf"><span class="nav-number">3.</span> <span class="nav-text">¶Protobuf</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#问题"><span class="nav-number">3.1.</span> <span class="nav-text">¶问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#netty-优化"><span class="nav-number">3.2.</span> <span class="nav-text">¶Netty 优化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cocos2d-x"><span class="nav-number">3.3.</span> <span class="nav-text">¶Cocos2d-X</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#node"><span class="nav-number">3.4.</span> <span class="nav-text">¶Node</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#scene"><span class="nav-number">3.5.</span> <span class="nav-text">¶Scene</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#layer"><span class="nav-number">3.6.</span> <span class="nav-text">¶Layer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sprite"><span class="nav-number">3.7.</span> <span class="nav-text">¶Sprite</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#director"><span class="nav-number">3.8.</span> <span class="nav-text">¶Director</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cache"><span class="nav-number">3.9.</span> <span class="nav-text">¶Cache</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#项目结构"><span class="nav-number">4.</span> <span class="nav-text">¶项目结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考"><span class="nav-number">5.</span> <span class="nav-text">¶参考</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#指令"><span class="nav-number">5.1.</span> <span class="nav-text">¶指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#指令服务器"><span class="nav-number">5.2.</span> <span class="nav-text">¶指令服务器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#视频"><span class="nav-number">5.3.</span> <span class="nav-text">¶视频</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#cocos2d-x-v2"><span class="nav-number">5.4.</span> <span class="nav-text">¶Cocos2d-x</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        

<div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">tallate</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>








        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i> 访问总量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      次
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '72bdd1c9479eb0679788',
          clientSecret: '62c9c0cb45aadb1478ca66cfc3c69c9623f50290',
          repo: 'tallate.github.io',
          owner: 'tallate',
          admin: ['tallate'],
          id: location.pathname,
          distractionFreeMode: 'true'
        })
        gitalk.render('gitalk-container')           
       </script>



  





  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  

  


</body>
</html>
